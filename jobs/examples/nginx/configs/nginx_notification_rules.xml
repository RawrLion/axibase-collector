<?xml version="1.0" encoding="UTF-8"?><rules>
<rule>
<name>nginx_active_connection_heartbeat</name>
<metric>nginx.active_connections</metric>
<expression><![CDATA[count() < (time_last() - time_first() + 1) / 5]]></expression>
<window>time(3 minute)</window>
<severity>WARNING</severity>
<alertOpenMessage><![CDATA[Open alert for ${entity}, ${metric}, ${tags}. Value: ${value}]]></alertOpenMessage>
<alertMessage><![CDATA[Repeat alert for ${entity}, ${metric}, ${tags}. Value: ${value}]]></alertMessage>
<alertCancellationMessage><![CDATA[Cancel alert for ${entity}, ${metric}, ${tags} . Value: ${value}]]></alertCancellationMessage>
<alertStrategy>
<type>NONE</type>
<intervalCount>5</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</alertStrategy>
<lastUpdated>1464089587908</lastUpdated>
<enabled>false</enabled>
<disableEntityGrouping>false</disableEntityGrouping>
<leavingEvents>true</leavingEvents>
<description><![CDATA[Raises an alert when insufficient amount of data about NGINX server's Active connections is received during last 3 minutes. 
If so, your server is likely to be unreachable. Check that your server is reachable and Collector is able to deliver collected information to ATSD.]]></description>
<actionStrategy>
<type>NONE</type>
<intervalCount>5</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</actionStrategy>
<groupFilter>nginx-servers</groupFilter>
<emailNotification>
<rule-name>nginx_active_connection_heartbeat</rule-name>
<repeat-interval>
<type>INTERVAL</type>
<intervalCount>3</intervalCount>
<intervalUnit>HOUR</intervalUnit>
</repeat-interval>
<name>Email Notification id=1</name>
<use-in-threshold-only>false</use-in-threshold-only>
<recipients>address@domain</recipients>
<first-subject>Rule ${rule}. Status ${status}. Entity: for ${entity}. Metric: ${metric}. Tags: ${tags}</first-subject>
<repeat-subject>Rule ${rule}. Status ${status}. Entity: for ${entity}. Metric: ${metric}. Tags: ${tags}. Duration: ${alert_duration_interval}</repeat-subject>
<cancel-subject>Rule ${rule}. Status ${status}. Entity: for ${entity}. Metric: ${metric}. Tags: ${tags}. Duration: ${alert_duration_interval}</cancel-subject>
<merge>false</merge>
<first-details>true</first-details>
<repeat-details>true</repeat-details>
<cancel-details>true</cancel-details>
<priority>0</priority>
</emailNotification>
<ruleTable/>
</rule>
<rule>
<name>nginx_active_connection_low</name>
<metric>nginx.active_connections</metric>
<expression><![CDATA[avg() < 10]]></expression>
<window>time(15 minute)</window>
<severity>WARNING</severity>
<alertOpenMessage><![CDATA[Open alert for ${entity}, ${metric}, ${tags}. Value: ${value}]]></alertOpenMessage>
<alertMessage><![CDATA[Repeat alert for ${entity}, ${metric}, ${tags}. Value: ${value}]]></alertMessage>
<alertCancellationMessage><![CDATA[Cancel alert for ${entity}, ${metric}, ${tags} . Value: ${value}]]></alertCancellationMessage>
<alertStrategy>
<type>NONE</type>
<intervalCount>5</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</alertStrategy>
<lastUpdated>1464089587931</lastUpdated>
<enabled>false</enabled>
<disableEntityGrouping>false</disableEntityGrouping>
<leavingEvents>true</leavingEvents>
<description><![CDATA[Raises an alert when NGINX server active connections count is low. 
If so, your server is likely to have probelms with accessibility. Check that your server has Internet access and is not configured with too small serving bandwidth.]]></description>
<actionStrategy>
<type>NONE</type>
<intervalCount>5</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</actionStrategy>
<groupFilter>nginx-servers</groupFilter>
<emailNotification>
<rule-name>nginx_active_connection_low</rule-name>
<repeat-interval>
<type>NONE</type>
<intervalCount>5</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</repeat-interval>
<name>Email Notification id=3</name>
<use-in-threshold-only>false</use-in-threshold-only>
<recipients>address@domain</recipients>
<first-subject>Rule ${rule}. Status ${status}. Entity: for ${entity}. Metric: ${metric}. Tags: ${tags}</first-subject>
<repeat-subject>Rule ${rule}. Status ${status}. Entity: for ${entity}. Metric: ${metric}. Tags: ${tags}. Duration: ${alert_duration_interval}</repeat-subject>
<cancel-subject>Rule ${rule}. Status ${status}. Entity: for ${entity}. Metric: ${metric}. Tags: ${tags}. Duration: ${alert_duration_interval}</cancel-subject>
<merge>false</merge>
<first-details>true</first-details>
<repeat-details>true</repeat-details>
<cancel-details>true</cancel-details>
<priority>0</priority>
</emailNotification>
<ruleTable/>
</rule>
<rule>
<name>nginx_tcp_heartbeat</name>
<metric>tcp-connect</metric>
<expression><![CDATA[(time_last() - time_first()) / 180  < 0.5]]></expression>
<window>time(3 minute)</window>
<filter>value = 0</filter>
<severity>WARNING</severity>
<alertOpenMessage><![CDATA[Open alert for ${entity}, ${metric}, ${tags}. Value: ${value}]]></alertOpenMessage>
<alertMessage><![CDATA[Repeat alert for ${entity}, ${metric}, ${tags}. Value: ${value}]]></alertMessage>
<alertCancellationMessage><![CDATA[Cancel alert for ${entity}, ${metric}, ${tags} . Value: ${value}]]></alertCancellationMessage>
<alertStrategy>
<type>NONE</type>
<intervalCount>5</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</alertStrategy>
<lastUpdated>1464089587952</lastUpdated>
<enabled>false</enabled>
<disableEntityGrouping>false</disableEntityGrouping>
<leavingEvents>true</leavingEvents>
<description><![CDATA[Raises an alert when it is problematic for your NGINX server to respond to tcp connections. Check that your nginx server is reachable and Collector can deliver collected information to ATSD.]]></description>
<actionStrategy>
<type>NONE</type>
<intervalCount>5</intervalCount>
<intervalUnit>MINUTE</intervalUnit>
</actionStrategy>
<groupFilter>nginx-servers</groupFilter>
<emailNotification>
<rule-name>nginx_tcp_heartbeat</rule-name>
<repeat-interval>
<type>INTERVAL</type>
<intervalCount>3</intervalCount>
<intervalUnit>HOUR</intervalUnit>
</repeat-interval>
<name>Email Notification id=1</name>
<use-in-threshold-only>false</use-in-threshold-only>
<recipients>address@domain</recipients>
<first-subject>Rule ${rule}. Status ${status}. Entity: for ${entity}. Metric: ${metric}. Tags: ${tags}</first-subject>
<repeat-subject>Rule ${rule}. Status ${status}. Entity: for ${entity}. Metric: ${metric}. Tags: ${tags}. Duration: ${alert_duration_interval}</repeat-subject>
<cancel-subject>Rule ${rule}. Status ${status}. Entity: for ${entity}. Metric: ${metric}. Tags: ${tags}. Duration: ${alert_duration_interval}</cancel-subject>
<merge>false</merge>
<first-details>true</first-details>
<repeat-details>true</repeat-details>
<cancel-details>true</cancel-details>
<priority>0</priority>
</emailNotification>
<ruleTable/>
</rule>
</rules>
